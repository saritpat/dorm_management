{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar React = require('react');\n\nvar core = require('@react-pdf-viewer/core');\n\nfunction _interopNamespace(e) {\n  if (e && e.__esModule) return e;\n  var n = Object.create(null);\n\n  if (e) {\n    Object.keys(e).forEach(function (k) {\n      if (k !== 'default') {\n        var d = Object.getOwnPropertyDescriptor(e, k);\n        Object.defineProperty(n, k, d.get ? d : {\n          enumerable: true,\n          get: function () {\n            return e[k];\n          }\n        });\n      }\n    });\n  }\n\n  n[\"default\"] = e;\n  return Object.freeze(n);\n}\n\nvar React__namespace = /*#__PURE__*/_interopNamespace(React);\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar EMPTY_KEYWORD_REGEXP = {\n  keyword: '',\n  regExp: new RegExp(' '),\n  wholeWords: false\n};\n\nvar escapeRegExp = function (input) {\n  return input.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n};\n\nvar normalizeFlagKeyword = function (flagKeyword) {\n  var source = flagKeyword.wholeWords ? \" \".concat(flagKeyword.keyword, \" \") : flagKeyword.keyword;\n  var flags = flagKeyword.matchCase ? 'g' : 'gi';\n  return {\n    keyword: flagKeyword.keyword,\n    regExp: new RegExp(escapeRegExp(source), flags),\n    wholeWords: flagKeyword.wholeWords || false\n  };\n};\n\nvar normalizeSingleKeyword = function (keyword, matchCase, wholeWords) {\n  if (keyword instanceof RegExp) {\n    return {\n      keyword: keyword.source,\n      regExp: keyword,\n      wholeWords: wholeWords || false\n    };\n  }\n\n  if (typeof keyword === 'string') {\n    return keyword === '' ? EMPTY_KEYWORD_REGEXP : normalizeFlagKeyword({\n      keyword: keyword,\n      matchCase: matchCase || false,\n      wholeWords: wholeWords || false\n    });\n  }\n\n  if (typeof matchCase !== 'undefined') {\n    keyword.matchCase = matchCase;\n  }\n\n  if (typeof wholeWords !== 'undefined') {\n    keyword.wholeWords = wholeWords;\n  }\n\n  return normalizeFlagKeyword(keyword);\n};\n\nvar useDocument = function (store) {\n  var currentDocRef = React__namespace.useRef(store.get('doc'));\n\n  var handleDocumentChanged = function (doc) {\n    currentDocRef.current = doc;\n  };\n\n  React__namespace.useEffect(function () {\n    store.subscribe('doc', handleDocumentChanged);\n    return function () {\n      store.unsubscribe('doc', handleDocumentChanged);\n    };\n  }, []);\n  return currentDocRef;\n};\n\nvar useSearch = function (store) {\n  var currentDocRef = useDocument(store);\n\n  var _a = React__namespace.useState([]),\n      keywords = _a[0],\n      setKeywords = _a[1];\n\n  var _b = React__namespace.useState([]),\n      found = _b[0],\n      setFound = _b[1];\n\n  var _c = React__namespace.useState(0),\n      currentMatch = _c[0],\n      setCurrentMatch = _c[1];\n\n  var _d = React__namespace.useState(false),\n      matchCase = _d[0],\n      setMatchCase = _d[1];\n\n  var textContents = React__namespace.useRef([]);\n\n  var _e = React__namespace.useState(false),\n      wholeWords = _e[0],\n      setWholeWords = _e[1];\n\n  var defaultTargetPageFilter = function () {\n    return true;\n  };\n\n  var targetPageFilter = React__namespace.useCallback(function () {\n    return store.get('targetPageFilter') || defaultTargetPageFilter;\n  }, [store.get('targetPageFilter')]);\n\n  var changeMatchCase = function (isChecked) {\n    setMatchCase(isChecked);\n\n    if (keywords.length > 0) {\n      searchFor(keywords, isChecked, wholeWords);\n    }\n  };\n\n  var changeWholeWords = function (isChecked) {\n    setWholeWords(isChecked);\n\n    if (keywords.length > 0) {\n      searchFor(keywords, matchCase, isChecked);\n    }\n  };\n\n  var jumpToMatch = function (index) {\n    if (keywords.length === 0 || found.length === 0) {\n      return null;\n    }\n\n    var normalizedIndex = Math.max(1, Math.min(found.length, index));\n    setCurrentMatch(normalizedIndex);\n    return jumpToGivenMatch(found[normalizedIndex - 1]);\n  };\n\n  var jumpToPreviousMatch = function () {\n    return jumpToMatch(currentMatch - 1);\n  };\n\n  var jumpToNextMatch = function () {\n    return jumpToMatch(currentMatch + 1);\n  };\n\n  var clearKeyword = function () {\n    store.update('keyword', [EMPTY_KEYWORD_REGEXP]);\n    setKeyword('');\n    setCurrentMatch(0);\n    setFound([]);\n    setMatchCase(false);\n    setWholeWords(false);\n  };\n\n  var search = function () {\n    return searchFor(keywords, matchCase, wholeWords);\n  };\n\n  var setKeyword = function (keyword) {\n    return setKeywords(keyword === '' ? [] : [keyword]);\n  };\n\n  var setTargetPages = function (targetPageFilter) {\n    store.update('targetPageFilter', targetPageFilter);\n  };\n\n  var getTextContents = function () {\n    var currentDoc = currentDocRef.current;\n\n    if (!currentDoc) {\n      return Promise.resolve([]);\n    }\n\n    var promises = Array(currentDoc.numPages).fill(0).map(function (_, pageIndex) {\n      return core.getPage(currentDoc, pageIndex).then(function (page) {\n        return page.getTextContent();\n      }).then(function (content) {\n        var pageContent = content.items.map(function (item) {\n          return item.str || '';\n        }).join('');\n        return Promise.resolve({\n          pageContent: pageContent,\n          pageIndex: pageIndex\n        });\n      });\n    });\n    return Promise.all(promises).then(function (data) {\n      data.sort(function (a, b) {\n        return a.pageIndex - b.pageIndex;\n      });\n      return Promise.resolve(data.map(function (item) {\n        return item.pageContent;\n      }));\n    });\n  };\n\n  var jumpToGivenMatch = function (match) {\n    var jumpToPage = store.get('jumpToPage');\n\n    if (jumpToPage) {\n      jumpToPage(match.pageIndex);\n    }\n\n    store.update('matchPosition', {\n      matchIndex: match.matchIndex,\n      pageIndex: match.pageIndex\n    });\n    return match;\n  };\n\n  var getKeywordSource = function (keyword) {\n    if (keyword instanceof RegExp) {\n      return keyword.source;\n    }\n\n    if (typeof keyword === 'string') {\n      return keyword;\n    }\n\n    return keyword.keyword;\n  };\n\n  var searchFor = function (keywordParam, matchCaseParam, wholeWordsParam) {\n    var currentDoc = currentDocRef.current;\n\n    if (!currentDoc) {\n      return Promise.resolve([]);\n    }\n\n    var numPages = currentDoc.numPages;\n    var keywords = keywordParam.map(function (k) {\n      return normalizeSingleKeyword(k, matchCaseParam, wholeWordsParam);\n    });\n    store.update('keyword', keywords);\n    setCurrentMatch(0);\n    setFound([]);\n    return new Promise(function (resolve, _) {\n      var getTextPromise = textContents.current.length === 0 ? getTextContents().then(function (response) {\n        textContents.current = response;\n        return Promise.resolve(response);\n      }) : Promise.resolve(textContents.current);\n      getTextPromise.then(function (response) {\n        var arr = [];\n        response.forEach(function (pageText, pageIndex) {\n          if (targetPageFilter()({\n            pageIndex: pageIndex,\n            numPages: numPages\n          })) {\n            keywords.forEach(function (keyword) {\n              var matchIndex = 0;\n              var matches;\n\n              while ((matches = keyword.regExp.exec(pageText)) !== null) {\n                arr.push({\n                  keyword: keyword.regExp,\n                  matchIndex: matchIndex,\n                  pageIndex: pageIndex,\n                  pageText: pageText,\n                  startIndex: matches.index,\n                  endIndex: keyword.regExp.lastIndex\n                });\n                matchIndex++;\n              }\n            });\n          }\n        });\n        setFound(arr);\n\n        if (arr.length > 0) {\n          setCurrentMatch(1);\n          jumpToGivenMatch(arr[0]);\n        }\n\n        resolve(arr);\n      });\n    });\n  };\n\n  React__namespace.useEffect(function () {\n    textContents.current = [];\n  }, [currentDocRef.current]);\n  return {\n    clearKeyword: clearKeyword,\n    changeMatchCase: changeMatchCase,\n    changeWholeWords: changeWholeWords,\n    currentMatch: currentMatch,\n    jumpToMatch: jumpToMatch,\n    jumpToNextMatch: jumpToNextMatch,\n    jumpToPreviousMatch: jumpToPreviousMatch,\n    keywords: keywords,\n    matchCase: matchCase,\n    numberOfMatches: found.length,\n    wholeWords: wholeWords,\n    search: search,\n    searchFor: searchFor,\n    setKeywords: setKeywords,\n    keyword: keywords.length === 0 ? '' : getKeywordSource(keywords[0]),\n    setKeyword: setKeyword,\n    setTargetPages: setTargetPages\n  };\n};\n\nvar Search = function (_a) {\n  var children = _a.children,\n      store = _a.store;\n  var result = useSearch(store);\n  return children(__assign({}, result));\n};\n\nvar ShortcutHandler = function (_a) {\n  var containerRef = _a.containerRef,\n      store = _a.store;\n\n  var _b = React__namespace.useState(true),\n      isMouseInside = _b[0],\n      setMouseInside = _b[1];\n\n  var handleMouseEnter = function () {\n    return setMouseInside(true);\n  };\n\n  var handleMouseLeave = function () {\n    return setMouseInside(false);\n  };\n\n  var handleKeydown = function (e) {\n    var containerEle = containerRef.current;\n\n    if (!containerEle) {\n      return;\n    }\n\n    if (e.shiftKey || e.altKey || e.key !== 'f') {\n      return;\n    }\n\n    var isCommandPressed = core.isMac() ? e.metaKey && !e.ctrlKey : e.ctrlKey;\n\n    if (!isCommandPressed) {\n      return;\n    }\n\n    if (isMouseInside || document.activeElement && containerEle.contains(document.activeElement)) {\n      e.preventDefault();\n      store.update('areShortcutsPressed', true);\n    }\n  };\n\n  React__namespace.useEffect(function () {\n    var containerEle = containerRef.current;\n\n    if (!containerEle) {\n      return;\n    }\n\n    document.addEventListener('keydown', handleKeydown);\n    containerEle.addEventListener('mouseenter', handleMouseEnter);\n    containerEle.addEventListener('mouseleave', handleMouseLeave);\n    return function () {\n      document.removeEventListener('keydown', handleKeydown);\n      containerEle.removeEventListener('mouseenter', handleMouseEnter);\n      containerEle.removeEventListener('mouseleave', handleMouseLeave);\n    };\n  }, [containerRef.current]);\n  return React__namespace.createElement(React__namespace.Fragment, null);\n};\n\nvar NextIcon = function () {\n  return React__namespace.createElement(core.Icon, {\n    size: 16\n  }, React__namespace.createElement(\"path\", {\n    d: \"M0.541,5.627L11.666,18.2c0.183,0.207,0.499,0.226,0.706,0.043c0.015-0.014,0.03-0.028,0.043-0.043\\n            L23.541,5.627\"\n  }));\n};\n\nvar PreviousIcon = function () {\n  return React__namespace.createElement(core.Icon, {\n    size: 16\n  }, React__namespace.createElement(\"path\", {\n    d: \"M23.535,18.373L12.409,5.8c-0.183-0.207-0.499-0.226-0.706-0.043C11.688,5.77,11.674,5.785,11.66,5.8\\n            L0.535,18.373\"\n  }));\n};\n\nvar PORTAL_OFFSET$1 = {\n  left: 0,\n  top: 8\n};\n\nvar SearchPopover = function (_a) {\n  var store = _a.store,\n      onToggle = _a.onToggle;\n  var l10n = React__namespace.useContext(core.LocalizationContext).l10n;\n  var direction = React__namespace.useContext(core.ThemeContext).direction;\n\n  var _b = React__namespace.useState(false),\n      isQuerying = _b[0],\n      setIsQuerying = _b[1];\n\n  var isRtl = direction === core.TextDirection.RightToLeft;\n\n  var _c = useSearch(store),\n      clearKeyword = _c.clearKeyword,\n      changeMatchCase = _c.changeMatchCase,\n      changeWholeWords = _c.changeWholeWords,\n      currentMatch = _c.currentMatch,\n      jumpToNextMatch = _c.jumpToNextMatch,\n      jumpToPreviousMatch = _c.jumpToPreviousMatch,\n      keyword = _c.keyword,\n      matchCase = _c.matchCase,\n      numberOfMatches = _c.numberOfMatches,\n      wholeWords = _c.wholeWords,\n      search = _c.search,\n      setKeyword = _c.setKeyword;\n\n  var onKeydownSearch = function (e) {\n    if (e.key === 'Enter' && keyword) {\n      setIsQuerying(true);\n      search().then(function (_) {\n        return setIsQuerying(false);\n      });\n    }\n  };\n\n  var onChangeMatchCase = function (e) {\n    changeMatchCase(e.target.checked);\n  };\n\n  var onChangeWholeWords = function (e) {\n    changeWholeWords(e.target.checked);\n  };\n\n  var onClose = function () {\n    onToggle();\n    clearKeyword();\n  };\n\n  var searchLabel = l10n && l10n.search ? l10n.search.enterToSearch : 'Enter to search';\n  var previousMatchLabel = l10n && l10n.search ? l10n.search.previousMatch : 'Previous match';\n  var nextMatchLabel = l10n && l10n.search ? l10n.search.nextMatch : 'Next match';\n  return React__namespace.createElement(\"div\", {\n    className: \"rpv-search__popover\"\n  }, React__namespace.createElement(\"div\", {\n    className: \"rpv-search__popover-input-counter\"\n  }, React__namespace.createElement(core.TextBox, {\n    ariaLabel: searchLabel,\n    autoFocus: true,\n    placeholder: searchLabel,\n    type: \"text\",\n    value: keyword,\n    onChange: setKeyword,\n    onKeyDown: onKeydownSearch\n  }), React__namespace.createElement(\"div\", {\n    className: core.classNames({\n      'rpv-search__popover-counter': true,\n      'rpv-search__popover-counter--ltr': !isRtl,\n      'rpv-search__popover-counter--rtl': isRtl\n    })\n  }, isQuerying && React__namespace.createElement(core.Spinner, {\n    size: \"1rem\"\n  }), !isQuerying && React__namespace.createElement(\"span\", null, currentMatch, \"/\", numberOfMatches))), React__namespace.createElement(\"label\", {\n    className: \"rpv-search__popover-label\"\n  }, React__namespace.createElement(\"input\", {\n    className: \"rpv-search__popover-label-checkbox\",\n    checked: matchCase,\n    type: \"checkbox\",\n    onChange: onChangeMatchCase\n  }), ' ', l10n && l10n.search ? l10n.search.matchCase : 'Match case'), React__namespace.createElement(\"label\", {\n    className: \"rpv-search__popover-label\"\n  }, React__namespace.createElement(\"input\", {\n    className: \"rpv-search__popover-label-checkbox\",\n    checked: wholeWords,\n    type: \"checkbox\",\n    onChange: onChangeWholeWords\n  }), ' ', l10n && l10n.search ? l10n.search.wholeWords : 'Whole words'), React__namespace.createElement(\"div\", {\n    className: \"rpv-search__popover-footer\"\n  }, React__namespace.createElement(\"div\", {\n    className: \"rpv-search__popover-footer-item\"\n  }, React__namespace.createElement(core.Tooltip, {\n    ariaControlsSuffix: \"search-previous-match\",\n    position: isRtl ? core.Position.BottomRight : core.Position.BottomCenter,\n    target: React__namespace.createElement(core.MinimalButton, {\n      ariaLabel: previousMatchLabel,\n      isDisabled: currentMatch <= 1,\n      onClick: jumpToPreviousMatch\n    }, React__namespace.createElement(PreviousIcon, null)),\n    content: function () {\n      return previousMatchLabel;\n    },\n    offset: PORTAL_OFFSET$1\n  })), React__namespace.createElement(\"div\", {\n    className: \"rpv-search__popover-footer-item\"\n  }, React__namespace.createElement(core.Tooltip, {\n    ariaControlsSuffix: \"search-next-match\",\n    position: core.Position.BottomCenter,\n    target: React__namespace.createElement(core.MinimalButton, {\n      ariaLabel: nextMatchLabel,\n      isDisabled: currentMatch > numberOfMatches - 1,\n      onClick: jumpToNextMatch\n    }, React__namespace.createElement(NextIcon, null)),\n    content: function () {\n      return nextMatchLabel;\n    },\n    offset: PORTAL_OFFSET$1\n  })), React__namespace.createElement(\"div\", {\n    className: core.classNames({\n      'rpv-search__popover-footer-button': true,\n      'rpv-search__popover-footer-button--ltr': !isRtl,\n      'rpv-search__popover-footer-button--rtl': isRtl\n    })\n  }, React__namespace.createElement(core.Button, {\n    onClick: onClose\n  }, l10n && l10n.search ? l10n.search.close : 'Close'))));\n};\n\nvar SearchIcon = function () {\n  return React__namespace.createElement(core.Icon, {\n    ignoreDirection: true,\n    size: 16\n  }, React__namespace.createElement(\"path\", {\n    d: \"M10.5,0.5c5.523,0,10,4.477,10,10s-4.477,10-10,10s-10-4.477-10-10S4.977,0.5,10.5,0.5z\\n            M23.5,23.5\\n            l-5.929-5.929\"\n  }));\n};\n\nvar ShowSearchPopoverDecorator = function (_a) {\n  var children = _a.children,\n      onClick = _a.onClick;\n  var l10n = React__namespace.useContext(core.LocalizationContext).l10n;\n  var label = l10n && l10n.search ? l10n.search.search : 'Search';\n  var icon = React__namespace.createElement(SearchIcon, null);\n  return children({\n    icon: icon,\n    label: label,\n    onClick: onClick\n  });\n};\n\nvar TOOLTIP_OFFSET = {\n  left: 0,\n  top: 8\n};\n\nvar ShowSearchPopoverButton = function (_a) {\n  var enableShortcuts = _a.enableShortcuts,\n      store = _a.store,\n      onClick = _a.onClick;\n  var ariaKeyShortcuts = enableShortcuts ? core.isMac() ? 'Meta+F' : 'Ctrl+F' : '';\n\n  var handleShortcutsPressed = function (areShortcutsPressed) {\n    if (areShortcutsPressed) {\n      onClick();\n    }\n  };\n\n  React__namespace.useEffect(function () {\n    store.subscribe('areShortcutsPressed', handleShortcutsPressed);\n    return function () {\n      store.unsubscribe('areShortcutsPressed', handleShortcutsPressed);\n    };\n  }, []);\n  return React__namespace.createElement(ShowSearchPopoverDecorator, {\n    onClick: onClick\n  }, function (p) {\n    return React__namespace.createElement(core.Tooltip, {\n      ariaControlsSuffix: \"search-popover\",\n      position: core.Position.BottomCenter,\n      target: React__namespace.createElement(core.MinimalButton, {\n        ariaKeyShortcuts: ariaKeyShortcuts,\n        ariaLabel: p.label,\n        testId: \"search__popover-button\",\n        onClick: onClick\n      }, p.icon),\n      content: function () {\n        return p.label;\n      },\n      offset: TOOLTIP_OFFSET\n    });\n  });\n};\n\nvar PORTAL_OFFSET = {\n  left: 0,\n  top: 8\n};\n\nvar ShowSearchPopover = function (_a) {\n  var children = _a.children,\n      enableShortcuts = _a.enableShortcuts,\n      store = _a.store;\n  var direction = React__namespace.useContext(core.ThemeContext).direction;\n  var portalPosition = direction === core.TextDirection.RightToLeft ? core.Position.BottomRight : core.Position.BottomLeft;\n\n  var defaultChildren = function (props) {\n    return React__namespace.createElement(ShowSearchPopoverButton, __assign({\n      enableShortcuts: enableShortcuts,\n      store: store\n    }, props));\n  };\n\n  var render = children || defaultChildren;\n  return React__namespace.createElement(core.Popover, {\n    ariaControlsSuffix: \"search\",\n    lockScroll: false,\n    position: portalPosition,\n    target: function (toggle) {\n      return render({\n        onClick: toggle\n      });\n    },\n    content: function (toggle) {\n      return React__namespace.createElement(SearchPopover, {\n        store: store,\n        onToggle: toggle\n      });\n    },\n    offset: PORTAL_OFFSET,\n    closeOnClickOutside: false,\n    closeOnEscape: true\n  });\n};\n\nvar calculateOffset = function (children, parent) {\n  var top = children.offsetTop;\n  var left = children.offsetLeft;\n  var p = children.parentElement;\n\n  while (p && p !== parent) {\n    top += p.offsetTop;\n    left += p.offsetLeft;\n    p = p.parentElement;\n  }\n\n  return {\n    left: left,\n    top: top\n  };\n};\n\nvar removeNode = function (ele) {\n  var parent = ele.parentNode;\n\n  if (parent) {\n    parent.removeChild(ele);\n  }\n};\n\nvar replaceNode = function (replacementNode, node) {\n  removeNode(replacementNode);\n  var parent = node.parentNode;\n\n  if (parent) {\n    parent.insertBefore(replacementNode, node);\n  }\n\n  removeNode(node);\n};\n\nvar unwrap = function (ele) {\n  var parent = ele.parentNode;\n\n  if (!parent) {\n    return;\n  }\n\n  var range = document.createRange();\n  range.selectNodeContents(ele);\n  replaceNode(range.extractContents(), ele);\n  parent.normalize();\n};\n\nvar percentToNumber = function (input) {\n  return parseFloat(input.slice(0, -1));\n};\n\nvar sortHighlightElements = function (a, b) {\n  var aTop = percentToNumber(a.style.top);\n  var aLeft = percentToNumber(a.style.left);\n  var bTop = percentToNumber(b.style.top);\n  var bLeft = percentToNumber(b.style.left);\n\n  if (aTop < bTop) {\n    return -1;\n  }\n\n  if (aTop > bTop) {\n    return 1;\n  }\n\n  if (aLeft < bLeft) {\n    return -1;\n  }\n\n  if (aLeft > bLeft) {\n    return 1;\n  }\n\n  return 0;\n};\n\nvar Tracker = function (_a) {\n  var numPages = _a.numPages,\n      pageIndex = _a.pageIndex,\n      store = _a.store,\n      onHighlightKeyword = _a.onHighlightKeyword;\n\n  var _b = React__namespace.useState(store.get('matchPosition')),\n      matchPosition = _b[0],\n      setMatchPosition = _b[1];\n\n  var _c = React__namespace.useState(store.get('keyword') || [EMPTY_KEYWORD_REGEXP]),\n      keywordRegexp = _c[0],\n      setKeywordRegexp = _c[1];\n\n  var _d = React__namespace.useState({\n    pageIndex: pageIndex,\n    scale: 1,\n    status: core.LayerRenderStatus.PreRender\n  }),\n      renderStatus = _d[0],\n      setRenderStatus = _d[1];\n\n  var currentMatchRef = React__namespace.useRef(null);\n  var characterIndexesRef = React__namespace.useRef([]);\n\n  var defaultTargetPageFilter = function () {\n    return true;\n  };\n\n  var targetPageFilter = React__namespace.useCallback(function () {\n    return store.get('targetPageFilter') || defaultTargetPageFilter;\n  }, [store.get('targetPageFilter')]);\n\n  var unhighlightAll = function (containerEle) {\n    var highlightNodes = containerEle.querySelectorAll('span.rpv-search__highlight');\n    var total = highlightNodes.length;\n\n    for (var i = 0; i < total; i++) {\n      highlightNodes[i].parentElement.removeChild(highlightNodes[i]);\n    }\n  };\n\n  var highlight = function (keywordStr, keyword, containerEle, span, charIndexSpan) {\n    var range = document.createRange();\n    var firstChild = span.firstChild;\n\n    if (!firstChild) {\n      return;\n    }\n\n    var startOffset = charIndexSpan[0].charIndexInSpan;\n    var endOffset = charIndexSpan.length === 1 ? startOffset : charIndexSpan[charIndexSpan.length - 1].charIndexInSpan;\n    range.setStart(firstChild, startOffset);\n    range.setEnd(firstChild, endOffset + 1);\n    var wrapper = document.createElement('span');\n    range.surroundContents(wrapper);\n    var wrapperRect = wrapper.getBoundingClientRect();\n    var containerRect = containerEle.getBoundingClientRect();\n    var highlightEle = document.createElement('span');\n    containerEle.insertBefore(highlightEle, containerEle.firstChild);\n    highlightEle.style.left = \"\".concat(100 * (wrapperRect.left - containerRect.left) / containerRect.width, \"%\");\n    highlightEle.style.top = \"\".concat(100 * (wrapperRect.top - containerRect.top) / containerRect.height, \"%\");\n    highlightEle.style.width = \"\".concat(100 * wrapperRect.width / containerRect.width, \"%\");\n    highlightEle.style.height = \"\".concat(100 * wrapperRect.height / containerRect.height, \"%\");\n    highlightEle.classList.add('rpv-search__highlight');\n    highlightEle.setAttribute('title', keywordStr.trim());\n    unwrap(wrapper);\n\n    if (onHighlightKeyword) {\n      onHighlightKeyword({\n        highlightEle: highlightEle,\n        keyword: keyword\n      });\n    }\n  };\n\n  var highlightAll = function (containerEle) {\n    var charIndexes = characterIndexesRef.current;\n\n    if (charIndexes.length === 0) {\n      return;\n    }\n\n    var spans = [].slice.call(containerEle.querySelectorAll('.rpv-core__text-layer-text'));\n    var fullText = charIndexes.map(function (item) {\n      return item.char;\n    }).join('');\n    keywordRegexp.forEach(function (keyword) {\n      var keywordStr = keyword.keyword;\n\n      if (!keywordStr.trim()) {\n        return;\n      }\n\n      var cloneKeyword = keyword.regExp.flags.indexOf('g') === -1 ? new RegExp(keyword.regExp, \"\".concat(keyword.regExp.flags, \"g\")) : keyword.regExp;\n      var match;\n      var matches = [];\n\n      while ((match = cloneKeyword.exec(fullText)) !== null) {\n        matches.push({\n          keyword: cloneKeyword,\n          startIndex: match.index,\n          endIndex: cloneKeyword.lastIndex\n        });\n      }\n\n      matches.map(function (item) {\n        return {\n          keyword: item.keyword,\n          indexes: charIndexes.slice(item.startIndex, item.endIndex)\n        };\n      }).forEach(function (item) {\n        var spanIndexes = item.indexes.reduce(function (acc, item) {\n          acc[item.spanIndex] = (acc[item.spanIndex] || []).concat([item]);\n          return acc;\n        }, {});\n        Object.values(spanIndexes).forEach(function (charIndexSpan) {\n          if (charIndexSpan.length !== 1 || charIndexSpan[0].char.trim() !== '') {\n            var normalizedCharSpan = keyword.wholeWords ? charIndexSpan.slice(1, -1) : charIndexSpan;\n            highlight(keywordStr, item.keyword, containerEle, spans[normalizedCharSpan[0].spanIndex], normalizedCharSpan);\n          }\n        });\n      });\n    });\n    var highlightEles = [].slice.call(containerEle.querySelectorAll('.rpv-search__highlight'));\n    highlightEles.sort(sortHighlightElements).forEach(function (ele, i) {\n      ele.setAttribute('data-index', \"\".concat(i));\n    });\n  };\n\n  var handleKeywordChanged = function (keyword) {\n    if (keyword && keyword.length > 0) {\n      setKeywordRegexp(keyword);\n    }\n  };\n\n  var handleMatchPositionChanged = function (currentPosition) {\n    return setMatchPosition(currentPosition);\n  };\n\n  var handleRenderStatusChanged = function (status) {\n    if (!status.has(pageIndex)) {\n      return;\n    }\n\n    var currentStatus = status.get(pageIndex);\n\n    if (currentStatus) {\n      setRenderStatus({\n        ele: currentStatus.ele,\n        pageIndex: pageIndex,\n        scale: currentStatus.scale,\n        status: currentStatus.status\n      });\n    }\n  };\n\n  var isEmptyKeyword = function () {\n    return keywordRegexp.length === 0 || keywordRegexp.length === 1 && keywordRegexp[0].keyword.trim() === '';\n  };\n\n  React__namespace.useEffect(function () {\n    if (isEmptyKeyword() || renderStatus.status !== core.LayerRenderStatus.DidRender || characterIndexesRef.current.length) {\n      return;\n    }\n\n    var containerEle = renderStatus.ele;\n    var spans = [].slice.call(containerEle.querySelectorAll('.rpv-core__text-layer-text'));\n    var charIndexes = spans.map(function (span) {\n      return span.textContent;\n    }).reduce(function (prev, curr, index) {\n      return prev.concat(curr.split('').map(function (c, i) {\n        return {\n          char: c,\n          charIndexInSpan: i,\n          spanIndex: index\n        };\n      }));\n    }, [{\n      char: '',\n      charIndexInSpan: 0,\n      spanIndex: 0\n    }]).slice(1);\n    characterIndexesRef.current = charIndexes;\n  }, [keywordRegexp, renderStatus.status]);\n  React__namespace.useEffect(function () {\n    if (isEmptyKeyword() || !renderStatus.ele || renderStatus.status !== core.LayerRenderStatus.DidRender || !targetPageFilter()({\n      pageIndex: pageIndex,\n      numPages: numPages\n    })) {\n      return;\n    }\n\n    var containerEle = renderStatus.ele;\n    unhighlightAll(containerEle);\n    highlightAll(containerEle);\n    scrollToMatch();\n  }, [keywordRegexp, matchPosition, renderStatus.status, characterIndexesRef.current]);\n  React__namespace.useEffect(function () {\n    if (isEmptyKeyword() && renderStatus.ele && renderStatus.status === core.LayerRenderStatus.DidRender) {\n      unhighlightAll(renderStatus.ele);\n    }\n  }, [keywordRegexp, renderStatus.status]);\n\n  var scrollToMatch = function () {\n    if (matchPosition.pageIndex !== pageIndex || !renderStatus.ele || renderStatus.status !== core.LayerRenderStatus.DidRender) {\n      return;\n    }\n\n    var container = renderStatus.ele;\n    var highlightEle = container.querySelector(\".rpv-search__highlight[data-index=\\\"\".concat(matchPosition.matchIndex, \"\\\"]\"));\n\n    if (!highlightEle) {\n      return;\n    }\n\n    var _a = calculateOffset(highlightEle, container),\n        left = _a.left,\n        top = _a.top;\n\n    var jump = store.get('jumpToDestination');\n\n    if (jump) {\n      jump(pageIndex, (container.getBoundingClientRect().height - top) / renderStatus.scale, left / renderStatus.scale, renderStatus.scale);\n\n      if (currentMatchRef.current) {\n        currentMatchRef.current.classList.remove('rpv-search__highlight--current');\n      }\n\n      currentMatchRef.current = highlightEle;\n      highlightEle.classList.add('rpv-search__highlight--current');\n    }\n  };\n\n  React__namespace.useEffect(function () {\n    store.subscribe('keyword', handleKeywordChanged);\n    store.subscribe('matchPosition', handleMatchPositionChanged);\n    store.subscribe('renderStatus', handleRenderStatusChanged);\n    return function () {\n      store.unsubscribe('keyword', handleKeywordChanged);\n      store.unsubscribe('matchPosition', handleMatchPositionChanged);\n      store.unsubscribe('renderStatus', handleRenderStatusChanged);\n    };\n  }, []);\n  return React__namespace.createElement(React__namespace.Fragment, null);\n};\n\nvar normalizeKeywords = function (keyword) {\n  return Array.isArray(keyword) ? keyword.map(function (k) {\n    return normalizeSingleKeyword(k);\n  }) : [normalizeSingleKeyword(keyword)];\n};\n\nvar searchPlugin = function (props) {\n  var searchPluginProps = React__namespace.useMemo(function () {\n    return Object.assign({}, {\n      enableShortcuts: true,\n      onHighlightKeyword: function () {}\n    }, props);\n  }, []);\n  var store = React__namespace.useMemo(function () {\n    return core.createStore({\n      matchPosition: {\n        matchIndex: -1,\n        pageIndex: -1\n      },\n      renderStatus: new Map(),\n      keyword: props && props.keyword ? normalizeKeywords(props.keyword) : [EMPTY_KEYWORD_REGEXP]\n    });\n  }, []);\n\n  var _a = useSearch(store),\n      clearKeyword = _a.clearKeyword,\n      jumpToMatch = _a.jumpToMatch,\n      jumpToNextMatch = _a.jumpToNextMatch,\n      jumpToPreviousMatch = _a.jumpToPreviousMatch,\n      searchFor = _a.searchFor,\n      setKeywords = _a.setKeywords,\n      setTargetPages = _a.setTargetPages;\n\n  var SearchDecorator = function (props) {\n    return React__namespace.createElement(Search, __assign({}, props, {\n      store: store\n    }));\n  };\n\n  var ShowSearchPopoverDecorator = function (props) {\n    return React__namespace.createElement(ShowSearchPopover, __assign({\n      enableShortcuts: searchPluginProps.enableShortcuts\n    }, props, {\n      store: store\n    }));\n  };\n\n  var ShowSearchPopoverButtonDecorator = function () {\n    return React__namespace.createElement(ShowSearchPopoverDecorator, null, function (props) {\n      return React__namespace.createElement(ShowSearchPopoverButton, __assign({\n        enableShortcuts: searchPluginProps.enableShortcuts,\n        store: store\n      }, props));\n    });\n  };\n\n  var renderViewer = function (renderViewerProps) {\n    var currentSlot = renderViewerProps.slot;\n\n    if (currentSlot.subSlot) {\n      currentSlot.subSlot.children = React__namespace.createElement(React__namespace.Fragment, null, searchPluginProps.enableShortcuts && React__namespace.createElement(ShortcutHandler, {\n        containerRef: renderViewerProps.containerRef,\n        store: store\n      }), currentSlot.subSlot.children);\n    }\n\n    return currentSlot;\n  };\n\n  var renderPageLayer = function (renderProps) {\n    return React__namespace.createElement(Tracker, {\n      key: renderProps.pageIndex,\n      numPages: renderProps.doc.numPages,\n      pageIndex: renderProps.pageIndex,\n      store: store,\n      onHighlightKeyword: searchPluginProps.onHighlightKeyword\n    });\n  };\n\n  return {\n    install: function (pluginFunctions) {\n      var keyword = props && props.keyword ? normalizeKeywords(props.keyword) : [EMPTY_KEYWORD_REGEXP];\n      store.update('jumpToDestination', pluginFunctions.jumpToDestination);\n      store.update('jumpToPage', pluginFunctions.jumpToPage);\n      store.update('keyword', keyword);\n    },\n    renderPageLayer: renderPageLayer,\n    renderViewer: renderViewer,\n    uninstall: function (props) {\n      var renderStatus = store.get('renderStatus');\n\n      if (renderStatus) {\n        renderStatus.clear();\n      }\n    },\n    onDocumentLoad: function (props) {\n      store.update('doc', props.doc);\n    },\n    onTextLayerRender: function (props) {\n      var renderStatus = store.get('renderStatus');\n\n      if (renderStatus) {\n        renderStatus = renderStatus.set(props.pageIndex, props);\n        store.update('renderStatus', renderStatus);\n      }\n    },\n    Search: SearchDecorator,\n    ShowSearchPopover: ShowSearchPopoverDecorator,\n    ShowSearchPopoverButton: ShowSearchPopoverButtonDecorator,\n    clearHighlights: function () {\n      clearKeyword();\n    },\n    highlight: function (keyword) {\n      var keywords = Array.isArray(keyword) ? keyword : [keyword];\n      setKeywords(keywords);\n      return searchFor(keywords);\n    },\n    jumpToMatch: jumpToMatch,\n    jumpToNextMatch: jumpToNextMatch,\n    jumpToPreviousMatch: jumpToPreviousMatch,\n    setTargetPages: setTargetPages\n  };\n};\n\nexports.NextIcon = NextIcon;\nexports.PreviousIcon = PreviousIcon;\nexports.SearchIcon = SearchIcon;\nexports.searchPlugin = searchPlugin;","map":{"version":3,"sources":["C:/Users/Sawid/Desktop/Asset/Project/dorm_management/node_modules/@react-pdf-viewer/search/lib/cjs/search.js"],"names":["Object","defineProperty","exports","value","React","require","core","_interopNamespace","e","__esModule","n","create","keys","forEach","k","d","getOwnPropertyDescriptor","get","enumerable","freeze","React__namespace","__assign","assign","t","s","i","arguments","length","p","prototype","hasOwnProperty","call","apply","EMPTY_KEYWORD_REGEXP","keyword","regExp","RegExp","wholeWords","escapeRegExp","input","replace","normalizeFlagKeyword","flagKeyword","source","concat","flags","matchCase","normalizeSingleKeyword","useDocument","store","currentDocRef","useRef","handleDocumentChanged","doc","current","useEffect","subscribe","unsubscribe","useSearch","_a","useState","keywords","setKeywords","_b","found","setFound","_c","currentMatch","setCurrentMatch","_d","setMatchCase","textContents","_e","setWholeWords","defaultTargetPageFilter","targetPageFilter","useCallback","changeMatchCase","isChecked","searchFor","changeWholeWords","jumpToMatch","index","normalizedIndex","Math","max","min","jumpToGivenMatch","jumpToPreviousMatch","jumpToNextMatch","clearKeyword","update","setKeyword","search","setTargetPages","getTextContents","currentDoc","Promise","resolve","promises","Array","numPages","fill","map","_","pageIndex","getPage","then","page","getTextContent","content","pageContent","items","item","str","join","all","data","sort","a","b","match","jumpToPage","matchIndex","getKeywordSource","keywordParam","matchCaseParam","wholeWordsParam","getTextPromise","response","arr","pageText","matches","exec","push","startIndex","endIndex","lastIndex","numberOfMatches","Search","children","result","ShortcutHandler","containerRef","isMouseInside","setMouseInside","handleMouseEnter","handleMouseLeave","handleKeydown","containerEle","shiftKey","altKey","key","isCommandPressed","isMac","metaKey","ctrlKey","document","activeElement","contains","preventDefault","addEventListener","removeEventListener","createElement","Fragment","NextIcon","Icon","size","PreviousIcon","PORTAL_OFFSET$1","left","top","SearchPopover","onToggle","l10n","useContext","LocalizationContext","direction","ThemeContext","isQuerying","setIsQuerying","isRtl","TextDirection","RightToLeft","onKeydownSearch","onChangeMatchCase","target","checked","onChangeWholeWords","onClose","searchLabel","enterToSearch","previousMatchLabel","previousMatch","nextMatchLabel","nextMatch","className","TextBox","ariaLabel","autoFocus","placeholder","type","onChange","onKeyDown","classNames","Spinner","Tooltip","ariaControlsSuffix","position","Position","BottomRight","BottomCenter","MinimalButton","isDisabled","onClick","offset","Button","close","SearchIcon","ignoreDirection","ShowSearchPopoverDecorator","label","icon","TOOLTIP_OFFSET","ShowSearchPopoverButton","enableShortcuts","ariaKeyShortcuts","handleShortcutsPressed","areShortcutsPressed","testId","PORTAL_OFFSET","ShowSearchPopover","portalPosition","BottomLeft","defaultChildren","props","render","Popover","lockScroll","toggle","closeOnClickOutside","closeOnEscape","calculateOffset","parent","offsetTop","offsetLeft","parentElement","removeNode","ele","parentNode","removeChild","replaceNode","replacementNode","node","insertBefore","unwrap","range","createRange","selectNodeContents","extractContents","normalize","percentToNumber","parseFloat","slice","sortHighlightElements","aTop","style","aLeft","bTop","bLeft","Tracker","onHighlightKeyword","matchPosition","setMatchPosition","keywordRegexp","setKeywordRegexp","scale","status","LayerRenderStatus","PreRender","renderStatus","setRenderStatus","currentMatchRef","characterIndexesRef","unhighlightAll","highlightNodes","querySelectorAll","total","highlight","keywordStr","span","charIndexSpan","firstChild","startOffset","charIndexInSpan","endOffset","setStart","setEnd","wrapper","surroundContents","wrapperRect","getBoundingClientRect","containerRect","highlightEle","width","height","classList","add","setAttribute","trim","highlightAll","charIndexes","spans","fullText","char","cloneKeyword","indexOf","indexes","spanIndexes","reduce","acc","spanIndex","values","normalizedCharSpan","highlightEles","handleKeywordChanged","handleMatchPositionChanged","currentPosition","handleRenderStatusChanged","has","currentStatus","isEmptyKeyword","DidRender","textContent","prev","curr","split","c","scrollToMatch","container","querySelector","jump","remove","normalizeKeywords","isArray","searchPlugin","searchPluginProps","useMemo","createStore","Map","SearchDecorator","ShowSearchPopoverButtonDecorator","renderViewer","renderViewerProps","currentSlot","slot","subSlot","renderPageLayer","renderProps","install","pluginFunctions","jumpToDestination","uninstall","clear","onDocumentLoad","onTextLayerRender","set","clearHighlights"],"mappings":"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","sourcesContent":["'use strict';\r\n\r\nObject.defineProperty(exports, '__esModule', { value: true });\r\n\r\nvar React = require('react');\r\nvar core = require('@react-pdf-viewer/core');\r\n\r\nfunction _interopNamespace(e) {\r\n    if (e && e.__esModule) return e;\r\n    var n = Object.create(null);\r\n    if (e) {\r\n        Object.keys(e).forEach(function (k) {\r\n            if (k !== 'default') {\r\n                var d = Object.getOwnPropertyDescriptor(e, k);\r\n                Object.defineProperty(n, k, d.get ? d : {\r\n                    enumerable: true,\r\n                    get: function () { return e[k]; }\r\n                });\r\n            }\r\n        });\r\n    }\r\n    n[\"default\"] = e;\r\n    return Object.freeze(n);\r\n}\r\n\r\nvar React__namespace = /*#__PURE__*/_interopNamespace(React);\r\n\r\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nvar EMPTY_KEYWORD_REGEXP = {\r\n    keyword: '',\r\n    regExp: new RegExp(' '),\r\n    wholeWords: false,\r\n};\r\n\r\nvar escapeRegExp = function (input) { return input.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); };\r\nvar normalizeFlagKeyword = function (flagKeyword) {\r\n    var source = flagKeyword.wholeWords ? \" \".concat(flagKeyword.keyword, \" \") : flagKeyword.keyword;\r\n    var flags = flagKeyword.matchCase ? 'g' : 'gi';\r\n    return {\r\n        keyword: flagKeyword.keyword,\r\n        regExp: new RegExp(escapeRegExp(source), flags),\r\n        wholeWords: flagKeyword.wholeWords || false,\r\n    };\r\n};\r\nvar normalizeSingleKeyword = function (keyword, matchCase, wholeWords) {\r\n    if (keyword instanceof RegExp) {\r\n        return {\r\n            keyword: keyword.source,\r\n            regExp: keyword,\r\n            wholeWords: wholeWords || false,\r\n        };\r\n    }\r\n    if (typeof keyword === 'string') {\r\n        return keyword === ''\r\n            ? EMPTY_KEYWORD_REGEXP\r\n            : normalizeFlagKeyword({\r\n                keyword: keyword,\r\n                matchCase: matchCase || false,\r\n                wholeWords: wholeWords || false,\r\n            });\r\n    }\r\n    if (typeof matchCase !== 'undefined') {\r\n        keyword.matchCase = matchCase;\r\n    }\r\n    if (typeof wholeWords !== 'undefined') {\r\n        keyword.wholeWords = wholeWords;\r\n    }\r\n    return normalizeFlagKeyword(keyword);\r\n};\r\n\r\nvar useDocument = function (store) {\r\n    var currentDocRef = React__namespace.useRef(store.get('doc'));\r\n    var handleDocumentChanged = function (doc) {\r\n        currentDocRef.current = doc;\r\n    };\r\n    React__namespace.useEffect(function () {\r\n        store.subscribe('doc', handleDocumentChanged);\r\n        return function () {\r\n            store.unsubscribe('doc', handleDocumentChanged);\r\n        };\r\n    }, []);\r\n    return currentDocRef;\r\n};\r\n\r\nvar useSearch = function (store) {\r\n    var currentDocRef = useDocument(store);\r\n    var _a = React__namespace.useState([]), keywords = _a[0], setKeywords = _a[1];\r\n    var _b = React__namespace.useState([]), found = _b[0], setFound = _b[1];\r\n    var _c = React__namespace.useState(0), currentMatch = _c[0], setCurrentMatch = _c[1];\r\n    var _d = React__namespace.useState(false), matchCase = _d[0], setMatchCase = _d[1];\r\n    var textContents = React__namespace.useRef([]);\r\n    var _e = React__namespace.useState(false), wholeWords = _e[0], setWholeWords = _e[1];\r\n    var defaultTargetPageFilter = function () { return true; };\r\n    var targetPageFilter = React__namespace.useCallback(function () { return store.get('targetPageFilter') || defaultTargetPageFilter; }, [store.get('targetPageFilter')]);\r\n    var changeMatchCase = function (isChecked) {\r\n        setMatchCase(isChecked);\r\n        if (keywords.length > 0) {\r\n            searchFor(keywords, isChecked, wholeWords);\r\n        }\r\n    };\r\n    var changeWholeWords = function (isChecked) {\r\n        setWholeWords(isChecked);\r\n        if (keywords.length > 0) {\r\n            searchFor(keywords, matchCase, isChecked);\r\n        }\r\n    };\r\n    var jumpToMatch = function (index) {\r\n        if (keywords.length === 0 || found.length === 0) {\r\n            return null;\r\n        }\r\n        var normalizedIndex = Math.max(1, Math.min(found.length, index));\r\n        setCurrentMatch(normalizedIndex);\r\n        return jumpToGivenMatch(found[normalizedIndex - 1]);\r\n    };\r\n    var jumpToPreviousMatch = function () { return jumpToMatch(currentMatch - 1); };\r\n    var jumpToNextMatch = function () { return jumpToMatch(currentMatch + 1); };\r\n    var clearKeyword = function () {\r\n        store.update('keyword', [EMPTY_KEYWORD_REGEXP]);\r\n        setKeyword('');\r\n        setCurrentMatch(0);\r\n        setFound([]);\r\n        setMatchCase(false);\r\n        setWholeWords(false);\r\n    };\r\n    var search = function () { return searchFor(keywords, matchCase, wholeWords); };\r\n    var setKeyword = function (keyword) { return setKeywords(keyword === '' ? [] : [keyword]); };\r\n    var setTargetPages = function (targetPageFilter) {\r\n        store.update('targetPageFilter', targetPageFilter);\r\n    };\r\n    var getTextContents = function () {\r\n        var currentDoc = currentDocRef.current;\r\n        if (!currentDoc) {\r\n            return Promise.resolve([]);\r\n        }\r\n        var promises = Array(currentDoc.numPages)\r\n            .fill(0)\r\n            .map(function (_, pageIndex) {\r\n            return core.getPage(currentDoc, pageIndex)\r\n                .then(function (page) {\r\n                return page.getTextContent();\r\n            })\r\n                .then(function (content) {\r\n                var pageContent = content.items.map(function (item) { return item.str || ''; }).join('');\r\n                return Promise.resolve({\r\n                    pageContent: pageContent,\r\n                    pageIndex: pageIndex,\r\n                });\r\n            });\r\n        });\r\n        return Promise.all(promises).then(function (data) {\r\n            data.sort(function (a, b) { return a.pageIndex - b.pageIndex; });\r\n            return Promise.resolve(data.map(function (item) { return item.pageContent; }));\r\n        });\r\n    };\r\n    var jumpToGivenMatch = function (match) {\r\n        var jumpToPage = store.get('jumpToPage');\r\n        if (jumpToPage) {\r\n            jumpToPage(match.pageIndex);\r\n        }\r\n        store.update('matchPosition', {\r\n            matchIndex: match.matchIndex,\r\n            pageIndex: match.pageIndex,\r\n        });\r\n        return match;\r\n    };\r\n    var getKeywordSource = function (keyword) {\r\n        if (keyword instanceof RegExp) {\r\n            return keyword.source;\r\n        }\r\n        if (typeof keyword === 'string') {\r\n            return keyword;\r\n        }\r\n        return keyword.keyword;\r\n    };\r\n    var searchFor = function (keywordParam, matchCaseParam, wholeWordsParam) {\r\n        var currentDoc = currentDocRef.current;\r\n        if (!currentDoc) {\r\n            return Promise.resolve([]);\r\n        }\r\n        var numPages = currentDoc.numPages;\r\n        var keywords = keywordParam.map(function (k) { return normalizeSingleKeyword(k, matchCaseParam, wholeWordsParam); });\r\n        store.update('keyword', keywords);\r\n        setCurrentMatch(0);\r\n        setFound([]);\r\n        return new Promise(function (resolve, _) {\r\n            var getTextPromise = textContents.current.length === 0\r\n                ? getTextContents().then(function (response) {\r\n                    textContents.current = response;\r\n                    return Promise.resolve(response);\r\n                })\r\n                : Promise.resolve(textContents.current);\r\n            getTextPromise.then(function (response) {\r\n                var arr = [];\r\n                response.forEach(function (pageText, pageIndex) {\r\n                    if (targetPageFilter()({ pageIndex: pageIndex, numPages: numPages })) {\r\n                        keywords.forEach(function (keyword) {\r\n                            var matchIndex = 0;\r\n                            var matches;\r\n                            while ((matches = keyword.regExp.exec(pageText)) !== null) {\r\n                                arr.push({\r\n                                    keyword: keyword.regExp,\r\n                                    matchIndex: matchIndex,\r\n                                    pageIndex: pageIndex,\r\n                                    pageText: pageText,\r\n                                    startIndex: matches.index,\r\n                                    endIndex: keyword.regExp.lastIndex,\r\n                                });\r\n                                matchIndex++;\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n                setFound(arr);\r\n                if (arr.length > 0) {\r\n                    setCurrentMatch(1);\r\n                    jumpToGivenMatch(arr[0]);\r\n                }\r\n                resolve(arr);\r\n            });\r\n        });\r\n    };\r\n    React__namespace.useEffect(function () {\r\n        textContents.current = [];\r\n    }, [currentDocRef.current]);\r\n    return {\r\n        clearKeyword: clearKeyword,\r\n        changeMatchCase: changeMatchCase,\r\n        changeWholeWords: changeWholeWords,\r\n        currentMatch: currentMatch,\r\n        jumpToMatch: jumpToMatch,\r\n        jumpToNextMatch: jumpToNextMatch,\r\n        jumpToPreviousMatch: jumpToPreviousMatch,\r\n        keywords: keywords,\r\n        matchCase: matchCase,\r\n        numberOfMatches: found.length,\r\n        wholeWords: wholeWords,\r\n        search: search,\r\n        searchFor: searchFor,\r\n        setKeywords: setKeywords,\r\n        keyword: keywords.length === 0 ? '' : getKeywordSource(keywords[0]),\r\n        setKeyword: setKeyword,\r\n        setTargetPages: setTargetPages,\r\n    };\r\n};\r\n\r\nvar Search = function (_a) {\r\n    var children = _a.children, store = _a.store;\r\n    var result = useSearch(store);\r\n    return children(__assign({}, result));\r\n};\r\n\r\nvar ShortcutHandler = function (_a) {\r\n    var containerRef = _a.containerRef, store = _a.store;\r\n    var _b = React__namespace.useState(true), isMouseInside = _b[0], setMouseInside = _b[1];\r\n    var handleMouseEnter = function () { return setMouseInside(true); };\r\n    var handleMouseLeave = function () { return setMouseInside(false); };\r\n    var handleKeydown = function (e) {\r\n        var containerEle = containerRef.current;\r\n        if (!containerEle) {\r\n            return;\r\n        }\r\n        if (e.shiftKey || e.altKey || e.key !== 'f') {\r\n            return;\r\n        }\r\n        var isCommandPressed = core.isMac() ? e.metaKey && !e.ctrlKey : e.ctrlKey;\r\n        if (!isCommandPressed) {\r\n            return;\r\n        }\r\n        if (isMouseInside || (document.activeElement && containerEle.contains(document.activeElement))) {\r\n            e.preventDefault();\r\n            store.update('areShortcutsPressed', true);\r\n        }\r\n    };\r\n    React__namespace.useEffect(function () {\r\n        var containerEle = containerRef.current;\r\n        if (!containerEle) {\r\n            return;\r\n        }\r\n        document.addEventListener('keydown', handleKeydown);\r\n        containerEle.addEventListener('mouseenter', handleMouseEnter);\r\n        containerEle.addEventListener('mouseleave', handleMouseLeave);\r\n        return function () {\r\n            document.removeEventListener('keydown', handleKeydown);\r\n            containerEle.removeEventListener('mouseenter', handleMouseEnter);\r\n            containerEle.removeEventListener('mouseleave', handleMouseLeave);\r\n        };\r\n    }, [containerRef.current]);\r\n    return React__namespace.createElement(React__namespace.Fragment, null);\r\n};\r\n\r\nvar NextIcon = function () { return (React__namespace.createElement(core.Icon, { size: 16 },\r\n    React__namespace.createElement(\"path\", { d: \"M0.541,5.627L11.666,18.2c0.183,0.207,0.499,0.226,0.706,0.043c0.015-0.014,0.03-0.028,0.043-0.043\\n            L23.541,5.627\" }))); };\r\n\r\nvar PreviousIcon = function () { return (React__namespace.createElement(core.Icon, { size: 16 },\r\n    React__namespace.createElement(\"path\", { d: \"M23.535,18.373L12.409,5.8c-0.183-0.207-0.499-0.226-0.706-0.043C11.688,5.77,11.674,5.785,11.66,5.8\\n            L0.535,18.373\" }))); };\r\n\r\nvar PORTAL_OFFSET$1 = { left: 0, top: 8 };\r\nvar SearchPopover = function (_a) {\r\n    var store = _a.store, onToggle = _a.onToggle;\r\n    var l10n = React__namespace.useContext(core.LocalizationContext).l10n;\r\n    var direction = React__namespace.useContext(core.ThemeContext).direction;\r\n    var _b = React__namespace.useState(false), isQuerying = _b[0], setIsQuerying = _b[1];\r\n    var isRtl = direction === core.TextDirection.RightToLeft;\r\n    var _c = useSearch(store), clearKeyword = _c.clearKeyword, changeMatchCase = _c.changeMatchCase, changeWholeWords = _c.changeWholeWords, currentMatch = _c.currentMatch, jumpToNextMatch = _c.jumpToNextMatch, jumpToPreviousMatch = _c.jumpToPreviousMatch, keyword = _c.keyword, matchCase = _c.matchCase, numberOfMatches = _c.numberOfMatches, wholeWords = _c.wholeWords, search = _c.search, setKeyword = _c.setKeyword;\r\n    var onKeydownSearch = function (e) {\r\n        if (e.key === 'Enter' && keyword) {\r\n            setIsQuerying(true);\r\n            search().then(function (_) { return setIsQuerying(false); });\r\n        }\r\n    };\r\n    var onChangeMatchCase = function (e) {\r\n        changeMatchCase(e.target.checked);\r\n    };\r\n    var onChangeWholeWords = function (e) {\r\n        changeWholeWords(e.target.checked);\r\n    };\r\n    var onClose = function () {\r\n        onToggle();\r\n        clearKeyword();\r\n    };\r\n    var searchLabel = l10n && l10n.search ? l10n.search.enterToSearch : 'Enter to search';\r\n    var previousMatchLabel = l10n && l10n.search ? l10n.search.previousMatch : 'Previous match';\r\n    var nextMatchLabel = l10n && l10n.search ? l10n.search.nextMatch : 'Next match';\r\n    return (React__namespace.createElement(\"div\", { className: \"rpv-search__popover\" },\r\n        React__namespace.createElement(\"div\", { className: \"rpv-search__popover-input-counter\" },\r\n            React__namespace.createElement(core.TextBox, { ariaLabel: searchLabel, autoFocus: true, placeholder: searchLabel, type: \"text\", value: keyword, onChange: setKeyword, onKeyDown: onKeydownSearch }),\r\n            React__namespace.createElement(\"div\", { className: core.classNames({\r\n                    'rpv-search__popover-counter': true,\r\n                    'rpv-search__popover-counter--ltr': !isRtl,\r\n                    'rpv-search__popover-counter--rtl': isRtl,\r\n                }) },\r\n                isQuerying && React__namespace.createElement(core.Spinner, { size: \"1rem\" }),\r\n                !isQuerying && (React__namespace.createElement(\"span\", null,\r\n                    currentMatch,\r\n                    \"/\",\r\n                    numberOfMatches)))),\r\n        React__namespace.createElement(\"label\", { className: \"rpv-search__popover-label\" },\r\n            React__namespace.createElement(\"input\", { className: \"rpv-search__popover-label-checkbox\", checked: matchCase, type: \"checkbox\", onChange: onChangeMatchCase }),\r\n            ' ',\r\n            l10n && l10n.search ? l10n.search.matchCase : 'Match case'),\r\n        React__namespace.createElement(\"label\", { className: \"rpv-search__popover-label\" },\r\n            React__namespace.createElement(\"input\", { className: \"rpv-search__popover-label-checkbox\", checked: wholeWords, type: \"checkbox\", onChange: onChangeWholeWords }),\r\n            ' ',\r\n            l10n && l10n.search ? l10n.search.wholeWords : 'Whole words'),\r\n        React__namespace.createElement(\"div\", { className: \"rpv-search__popover-footer\" },\r\n            React__namespace.createElement(\"div\", { className: \"rpv-search__popover-footer-item\" },\r\n                React__namespace.createElement(core.Tooltip, { ariaControlsSuffix: \"search-previous-match\", position: isRtl ? core.Position.BottomRight : core.Position.BottomCenter, target: React__namespace.createElement(core.MinimalButton, { ariaLabel: previousMatchLabel, isDisabled: currentMatch <= 1, onClick: jumpToPreviousMatch },\r\n                        React__namespace.createElement(PreviousIcon, null)), content: function () { return previousMatchLabel; }, offset: PORTAL_OFFSET$1 })),\r\n            React__namespace.createElement(\"div\", { className: \"rpv-search__popover-footer-item\" },\r\n                React__namespace.createElement(core.Tooltip, { ariaControlsSuffix: \"search-next-match\", position: core.Position.BottomCenter, target: React__namespace.createElement(core.MinimalButton, { ariaLabel: nextMatchLabel, isDisabled: currentMatch > numberOfMatches - 1, onClick: jumpToNextMatch },\r\n                        React__namespace.createElement(NextIcon, null)), content: function () { return nextMatchLabel; }, offset: PORTAL_OFFSET$1 })),\r\n            React__namespace.createElement(\"div\", { className: core.classNames({\r\n                    'rpv-search__popover-footer-button': true,\r\n                    'rpv-search__popover-footer-button--ltr': !isRtl,\r\n                    'rpv-search__popover-footer-button--rtl': isRtl,\r\n                }) },\r\n                React__namespace.createElement(core.Button, { onClick: onClose }, l10n && l10n.search ? l10n.search.close : 'Close')))));\r\n};\r\n\r\nvar SearchIcon = function () { return (React__namespace.createElement(core.Icon, { ignoreDirection: true, size: 16 },\r\n    React__namespace.createElement(\"path\", { d: \"M10.5,0.5c5.523,0,10,4.477,10,10s-4.477,10-10,10s-10-4.477-10-10S4.977,0.5,10.5,0.5z\\n            M23.5,23.5\\n            l-5.929-5.929\" }))); };\r\n\r\nvar ShowSearchPopoverDecorator = function (_a) {\r\n    var children = _a.children, onClick = _a.onClick;\r\n    var l10n = React__namespace.useContext(core.LocalizationContext).l10n;\r\n    var label = l10n && l10n.search ? l10n.search.search : 'Search';\r\n    var icon = React__namespace.createElement(SearchIcon, null);\r\n    return children({ icon: icon, label: label, onClick: onClick });\r\n};\r\n\r\nvar TOOLTIP_OFFSET = { left: 0, top: 8 };\r\nvar ShowSearchPopoverButton = function (_a) {\r\n    var enableShortcuts = _a.enableShortcuts, store = _a.store, onClick = _a.onClick;\r\n    var ariaKeyShortcuts = enableShortcuts ? (core.isMac() ? 'Meta+F' : 'Ctrl+F') : '';\r\n    var handleShortcutsPressed = function (areShortcutsPressed) {\r\n        if (areShortcutsPressed) {\r\n            onClick();\r\n        }\r\n    };\r\n    React__namespace.useEffect(function () {\r\n        store.subscribe('areShortcutsPressed', handleShortcutsPressed);\r\n        return function () {\r\n            store.unsubscribe('areShortcutsPressed', handleShortcutsPressed);\r\n        };\r\n    }, []);\r\n    return (React__namespace.createElement(ShowSearchPopoverDecorator, { onClick: onClick }, function (p) { return (React__namespace.createElement(core.Tooltip, { ariaControlsSuffix: \"search-popover\", position: core.Position.BottomCenter, target: React__namespace.createElement(core.MinimalButton, { ariaKeyShortcuts: ariaKeyShortcuts, ariaLabel: p.label, testId: \"search__popover-button\", onClick: onClick }, p.icon), content: function () { return p.label; }, offset: TOOLTIP_OFFSET })); }));\r\n};\r\n\r\nvar PORTAL_OFFSET = { left: 0, top: 8 };\r\nvar ShowSearchPopover = function (_a) {\r\n    var children = _a.children, enableShortcuts = _a.enableShortcuts, store = _a.store;\r\n    var direction = React__namespace.useContext(core.ThemeContext).direction;\r\n    var portalPosition = direction === core.TextDirection.RightToLeft ? core.Position.BottomRight : core.Position.BottomLeft;\r\n    var defaultChildren = function (props) { return (React__namespace.createElement(ShowSearchPopoverButton, __assign({ enableShortcuts: enableShortcuts, store: store }, props))); };\r\n    var render = children || defaultChildren;\r\n    return (React__namespace.createElement(core.Popover, { ariaControlsSuffix: \"search\", lockScroll: false, position: portalPosition, target: function (toggle) {\r\n            return render({\r\n                onClick: toggle,\r\n            });\r\n        }, content: function (toggle) { return React__namespace.createElement(SearchPopover, { store: store, onToggle: toggle }); }, offset: PORTAL_OFFSET, closeOnClickOutside: false, closeOnEscape: true }));\r\n};\r\n\r\nvar calculateOffset = function (children, parent) {\r\n    var top = children.offsetTop;\r\n    var left = children.offsetLeft;\r\n    var p = children.parentElement;\r\n    while (p && p !== parent) {\r\n        top += p.offsetTop;\r\n        left += p.offsetLeft;\r\n        p = p.parentElement;\r\n    }\r\n    return {\r\n        left: left,\r\n        top: top,\r\n    };\r\n};\r\n\r\nvar removeNode = function (ele) {\r\n    var parent = ele.parentNode;\r\n    if (parent) {\r\n        parent.removeChild(ele);\r\n    }\r\n};\r\nvar replaceNode = function (replacementNode, node) {\r\n    removeNode(replacementNode);\r\n    var parent = node.parentNode;\r\n    if (parent) {\r\n        parent.insertBefore(replacementNode, node);\r\n    }\r\n    removeNode(node);\r\n};\r\nvar unwrap = function (ele) {\r\n    var parent = ele.parentNode;\r\n    if (!parent) {\r\n        return;\r\n    }\r\n    var range = document.createRange();\r\n    range.selectNodeContents(ele);\r\n    replaceNode(range.extractContents(), ele);\r\n    parent.normalize();\r\n};\r\n\r\nvar percentToNumber = function (input) { return parseFloat(input.slice(0, -1)); };\r\nvar sortHighlightElements = function (a, b) {\r\n    var aTop = percentToNumber(a.style.top);\r\n    var aLeft = percentToNumber(a.style.left);\r\n    var bTop = percentToNumber(b.style.top);\r\n    var bLeft = percentToNumber(b.style.left);\r\n    if (aTop < bTop) {\r\n        return -1;\r\n    }\r\n    if (aTop > bTop) {\r\n        return 1;\r\n    }\r\n    if (aLeft < bLeft) {\r\n        return -1;\r\n    }\r\n    if (aLeft > bLeft) {\r\n        return 1;\r\n    }\r\n    return 0;\r\n};\r\nvar Tracker = function (_a) {\r\n    var numPages = _a.numPages, pageIndex = _a.pageIndex, store = _a.store, onHighlightKeyword = _a.onHighlightKeyword;\r\n    var _b = React__namespace.useState(store.get('matchPosition')), matchPosition = _b[0], setMatchPosition = _b[1];\r\n    var _c = React__namespace.useState(store.get('keyword') || [EMPTY_KEYWORD_REGEXP]), keywordRegexp = _c[0], setKeywordRegexp = _c[1];\r\n    var _d = React__namespace.useState({\r\n        pageIndex: pageIndex,\r\n        scale: 1,\r\n        status: core.LayerRenderStatus.PreRender,\r\n    }), renderStatus = _d[0], setRenderStatus = _d[1];\r\n    var currentMatchRef = React__namespace.useRef(null);\r\n    var characterIndexesRef = React__namespace.useRef([]);\r\n    var defaultTargetPageFilter = function () { return true; };\r\n    var targetPageFilter = React__namespace.useCallback(function () { return store.get('targetPageFilter') || defaultTargetPageFilter; }, [store.get('targetPageFilter')]);\r\n    var unhighlightAll = function (containerEle) {\r\n        var highlightNodes = containerEle.querySelectorAll('span.rpv-search__highlight');\r\n        var total = highlightNodes.length;\r\n        for (var i = 0; i < total; i++) {\r\n            highlightNodes[i].parentElement.removeChild(highlightNodes[i]);\r\n        }\r\n    };\r\n    var highlight = function (keywordStr, keyword, containerEle, span, charIndexSpan) {\r\n        var range = document.createRange();\r\n        var firstChild = span.firstChild;\r\n        if (!firstChild) {\r\n            return;\r\n        }\r\n        var startOffset = charIndexSpan[0].charIndexInSpan;\r\n        var endOffset = charIndexSpan.length === 1 ? startOffset : charIndexSpan[charIndexSpan.length - 1].charIndexInSpan;\r\n        range.setStart(firstChild, startOffset);\r\n        range.setEnd(firstChild, endOffset + 1);\r\n        var wrapper = document.createElement('span');\r\n        range.surroundContents(wrapper);\r\n        var wrapperRect = wrapper.getBoundingClientRect();\r\n        var containerRect = containerEle.getBoundingClientRect();\r\n        var highlightEle = document.createElement('span');\r\n        containerEle.insertBefore(highlightEle, containerEle.firstChild);\r\n        highlightEle.style.left = \"\".concat((100 * (wrapperRect.left - containerRect.left)) / containerRect.width, \"%\");\r\n        highlightEle.style.top = \"\".concat((100 * (wrapperRect.top - containerRect.top)) / containerRect.height, \"%\");\r\n        highlightEle.style.width = \"\".concat((100 * wrapperRect.width) / containerRect.width, \"%\");\r\n        highlightEle.style.height = \"\".concat((100 * wrapperRect.height) / containerRect.height, \"%\");\r\n        highlightEle.classList.add('rpv-search__highlight');\r\n        highlightEle.setAttribute('title', keywordStr.trim());\r\n        unwrap(wrapper);\r\n        if (onHighlightKeyword) {\r\n            onHighlightKeyword({\r\n                highlightEle: highlightEle,\r\n                keyword: keyword,\r\n            });\r\n        }\r\n    };\r\n    var highlightAll = function (containerEle) {\r\n        var charIndexes = characterIndexesRef.current;\r\n        if (charIndexes.length === 0) {\r\n            return;\r\n        }\r\n        var spans = [].slice.call(containerEle.querySelectorAll('.rpv-core__text-layer-text'));\r\n        var fullText = charIndexes.map(function (item) { return item.char; }).join('');\r\n        keywordRegexp.forEach(function (keyword) {\r\n            var keywordStr = keyword.keyword;\r\n            if (!keywordStr.trim()) {\r\n                return;\r\n            }\r\n            var cloneKeyword = keyword.regExp.flags.indexOf('g') === -1\r\n                ? new RegExp(keyword.regExp, \"\".concat(keyword.regExp.flags, \"g\"))\r\n                : keyword.regExp;\r\n            var match;\r\n            var matches = [];\r\n            while ((match = cloneKeyword.exec(fullText)) !== null) {\r\n                matches.push({\r\n                    keyword: cloneKeyword,\r\n                    startIndex: match.index,\r\n                    endIndex: cloneKeyword.lastIndex,\r\n                });\r\n            }\r\n            matches\r\n                .map(function (item) { return ({\r\n                keyword: item.keyword,\r\n                indexes: charIndexes.slice(item.startIndex, item.endIndex),\r\n            }); })\r\n                .forEach(function (item) {\r\n                var spanIndexes = item.indexes.reduce(function (acc, item) {\r\n                    acc[item.spanIndex] = (acc[item.spanIndex] || []).concat([item]);\r\n                    return acc;\r\n                }, {});\r\n                Object.values(spanIndexes).forEach(function (charIndexSpan) {\r\n                    if (charIndexSpan.length !== 1 || charIndexSpan[0].char.trim() !== '') {\r\n                        var normalizedCharSpan = keyword.wholeWords ? charIndexSpan.slice(1, -1) : charIndexSpan;\r\n                        highlight(keywordStr, item.keyword, containerEle, spans[normalizedCharSpan[0].spanIndex], normalizedCharSpan);\r\n                    }\r\n                });\r\n            });\r\n        });\r\n        var highlightEles = [].slice.call(containerEle.querySelectorAll('.rpv-search__highlight'));\r\n        highlightEles.sort(sortHighlightElements).forEach(function (ele, i) {\r\n            ele.setAttribute('data-index', \"\".concat(i));\r\n        });\r\n    };\r\n    var handleKeywordChanged = function (keyword) {\r\n        if (keyword && keyword.length > 0) {\r\n            setKeywordRegexp(keyword);\r\n        }\r\n    };\r\n    var handleMatchPositionChanged = function (currentPosition) { return setMatchPosition(currentPosition); };\r\n    var handleRenderStatusChanged = function (status) {\r\n        if (!status.has(pageIndex)) {\r\n            return;\r\n        }\r\n        var currentStatus = status.get(pageIndex);\r\n        if (currentStatus) {\r\n            setRenderStatus({\r\n                ele: currentStatus.ele,\r\n                pageIndex: pageIndex,\r\n                scale: currentStatus.scale,\r\n                status: currentStatus.status,\r\n            });\r\n        }\r\n    };\r\n    var isEmptyKeyword = function () {\r\n        return keywordRegexp.length === 0 || (keywordRegexp.length === 1 && keywordRegexp[0].keyword.trim() === '');\r\n    };\r\n    React__namespace.useEffect(function () {\r\n        if (isEmptyKeyword() ||\r\n            renderStatus.status !== core.LayerRenderStatus.DidRender ||\r\n            characterIndexesRef.current.length) {\r\n            return;\r\n        }\r\n        var containerEle = renderStatus.ele;\r\n        var spans = [].slice.call(containerEle.querySelectorAll('.rpv-core__text-layer-text'));\r\n        var charIndexes = spans\r\n            .map(function (span) { return span.textContent; })\r\n            .reduce(function (prev, curr, index) {\r\n            return prev.concat(curr.split('').map(function (c, i) { return ({\r\n                char: c,\r\n                charIndexInSpan: i,\r\n                spanIndex: index,\r\n            }); }));\r\n        }, [\r\n            {\r\n                char: '',\r\n                charIndexInSpan: 0,\r\n                spanIndex: 0,\r\n            },\r\n        ])\r\n            .slice(1);\r\n        characterIndexesRef.current = charIndexes;\r\n    }, [keywordRegexp, renderStatus.status]);\r\n    React__namespace.useEffect(function () {\r\n        if (isEmptyKeyword() ||\r\n            !renderStatus.ele ||\r\n            renderStatus.status !== core.LayerRenderStatus.DidRender ||\r\n            !targetPageFilter()({ pageIndex: pageIndex, numPages: numPages })) {\r\n            return;\r\n        }\r\n        var containerEle = renderStatus.ele;\r\n        unhighlightAll(containerEle);\r\n        highlightAll(containerEle);\r\n        scrollToMatch();\r\n    }, [keywordRegexp, matchPosition, renderStatus.status, characterIndexesRef.current]);\r\n    React__namespace.useEffect(function () {\r\n        if (isEmptyKeyword() && renderStatus.ele && renderStatus.status === core.LayerRenderStatus.DidRender) {\r\n            unhighlightAll(renderStatus.ele);\r\n        }\r\n    }, [keywordRegexp, renderStatus.status]);\r\n    var scrollToMatch = function () {\r\n        if (matchPosition.pageIndex !== pageIndex ||\r\n            !renderStatus.ele ||\r\n            renderStatus.status !== core.LayerRenderStatus.DidRender) {\r\n            return;\r\n        }\r\n        var container = renderStatus.ele;\r\n        var highlightEle = container.querySelector(\".rpv-search__highlight[data-index=\\\"\".concat(matchPosition.matchIndex, \"\\\"]\"));\r\n        if (!highlightEle) {\r\n            return;\r\n        }\r\n        var _a = calculateOffset(highlightEle, container), left = _a.left, top = _a.top;\r\n        var jump = store.get('jumpToDestination');\r\n        if (jump) {\r\n            jump(pageIndex, (container.getBoundingClientRect().height - top) / renderStatus.scale, left / renderStatus.scale, renderStatus.scale);\r\n            if (currentMatchRef.current) {\r\n                currentMatchRef.current.classList.remove('rpv-search__highlight--current');\r\n            }\r\n            currentMatchRef.current = highlightEle;\r\n            highlightEle.classList.add('rpv-search__highlight--current');\r\n        }\r\n    };\r\n    React__namespace.useEffect(function () {\r\n        store.subscribe('keyword', handleKeywordChanged);\r\n        store.subscribe('matchPosition', handleMatchPositionChanged);\r\n        store.subscribe('renderStatus', handleRenderStatusChanged);\r\n        return function () {\r\n            store.unsubscribe('keyword', handleKeywordChanged);\r\n            store.unsubscribe('matchPosition', handleMatchPositionChanged);\r\n            store.unsubscribe('renderStatus', handleRenderStatusChanged);\r\n        };\r\n    }, []);\r\n    return React__namespace.createElement(React__namespace.Fragment, null);\r\n};\r\n\r\nvar normalizeKeywords = function (keyword) {\r\n    return Array.isArray(keyword) ? keyword.map(function (k) { return normalizeSingleKeyword(k); }) : [normalizeSingleKeyword(keyword)];\r\n};\r\nvar searchPlugin = function (props) {\r\n    var searchPluginProps = React__namespace.useMemo(function () { return Object.assign({}, { enableShortcuts: true, onHighlightKeyword: function () { } }, props); }, []);\r\n    var store = React__namespace.useMemo(function () {\r\n        return core.createStore({\r\n            matchPosition: {\r\n                matchIndex: -1,\r\n                pageIndex: -1,\r\n            },\r\n            renderStatus: new Map(),\r\n            keyword: props && props.keyword ? normalizeKeywords(props.keyword) : [EMPTY_KEYWORD_REGEXP],\r\n        });\r\n    }, []);\r\n    var _a = useSearch(store), clearKeyword = _a.clearKeyword, jumpToMatch = _a.jumpToMatch, jumpToNextMatch = _a.jumpToNextMatch, jumpToPreviousMatch = _a.jumpToPreviousMatch, searchFor = _a.searchFor, setKeywords = _a.setKeywords, setTargetPages = _a.setTargetPages;\r\n    var SearchDecorator = function (props) { return React__namespace.createElement(Search, __assign({}, props, { store: store })); };\r\n    var ShowSearchPopoverDecorator = function (props) { return (React__namespace.createElement(ShowSearchPopover, __assign({ enableShortcuts: searchPluginProps.enableShortcuts }, props, { store: store }))); };\r\n    var ShowSearchPopoverButtonDecorator = function () { return (React__namespace.createElement(ShowSearchPopoverDecorator, null, function (props) { return (React__namespace.createElement(ShowSearchPopoverButton, __assign({ enableShortcuts: searchPluginProps.enableShortcuts, store: store }, props))); })); };\r\n    var renderViewer = function (renderViewerProps) {\r\n        var currentSlot = renderViewerProps.slot;\r\n        if (currentSlot.subSlot) {\r\n            currentSlot.subSlot.children = (React__namespace.createElement(React__namespace.Fragment, null,\r\n                searchPluginProps.enableShortcuts && (React__namespace.createElement(ShortcutHandler, { containerRef: renderViewerProps.containerRef, store: store })),\r\n                currentSlot.subSlot.children));\r\n        }\r\n        return currentSlot;\r\n    };\r\n    var renderPageLayer = function (renderProps) { return (React__namespace.createElement(Tracker, { key: renderProps.pageIndex, numPages: renderProps.doc.numPages, pageIndex: renderProps.pageIndex, store: store, onHighlightKeyword: searchPluginProps.onHighlightKeyword })); };\r\n    return {\r\n        install: function (pluginFunctions) {\r\n            var keyword = props && props.keyword ? normalizeKeywords(props.keyword) : [EMPTY_KEYWORD_REGEXP];\r\n            store.update('jumpToDestination', pluginFunctions.jumpToDestination);\r\n            store.update('jumpToPage', pluginFunctions.jumpToPage);\r\n            store.update('keyword', keyword);\r\n        },\r\n        renderPageLayer: renderPageLayer,\r\n        renderViewer: renderViewer,\r\n        uninstall: function (props) {\r\n            var renderStatus = store.get('renderStatus');\r\n            if (renderStatus) {\r\n                renderStatus.clear();\r\n            }\r\n        },\r\n        onDocumentLoad: function (props) {\r\n            store.update('doc', props.doc);\r\n        },\r\n        onTextLayerRender: function (props) {\r\n            var renderStatus = store.get('renderStatus');\r\n            if (renderStatus) {\r\n                renderStatus = renderStatus.set(props.pageIndex, props);\r\n                store.update('renderStatus', renderStatus);\r\n            }\r\n        },\r\n        Search: SearchDecorator,\r\n        ShowSearchPopover: ShowSearchPopoverDecorator,\r\n        ShowSearchPopoverButton: ShowSearchPopoverButtonDecorator,\r\n        clearHighlights: function () {\r\n            clearKeyword();\r\n        },\r\n        highlight: function (keyword) {\r\n            var keywords = Array.isArray(keyword) ? keyword : [keyword];\r\n            setKeywords(keywords);\r\n            return searchFor(keywords);\r\n        },\r\n        jumpToMatch: jumpToMatch,\r\n        jumpToNextMatch: jumpToNextMatch,\r\n        jumpToPreviousMatch: jumpToPreviousMatch,\r\n        setTargetPages: setTargetPages,\r\n    };\r\n};\r\n\r\nexports.NextIcon = NextIcon;\r\nexports.PreviousIcon = PreviousIcon;\r\nexports.SearchIcon = SearchIcon;\r\nexports.searchPlugin = searchPlugin;\r\n"]},"metadata":{},"sourceType":"script"}